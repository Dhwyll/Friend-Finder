<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>FriendFinder</title>

		<!-- jQuery -->
		<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
		
		<!-- Compiled and minified CSS for Materialize -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
		
		<!-- Compiled and minified JavaScript for Materialize-->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

		<!-- Materialize Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

		<!-- Font Awesome Glyphicons -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

	</head>
	<body>

		<div class="container">
			<h4>Survey Questions</h4>
			<hr>
			<div class="row">
				<form class="col s12" name="userInfo">
					<h5><strong>About You</strong></h5>
					<div class="row">
						<div class="input-field col s12">
							<i class="material-icons prefix">account_circle</i>
							<input class="form-control" id="name" type="text" required="" aria-required="true">
							<label for="name">Name (required)</label>
						</div>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<i class="material-icons prefix">camera</i>
							<input class="form-control" id="photo" type="text" required="" aria-required="true">
							<label for="photo">Link to Photo Image (required)</label>
						</div>
					</div>
					<hr>
				</form>
			</div>

			<h5><strong>The Questions</strong></h5>
			<div class="row">
			<form>
				<div class="input-field col s12">
					<select class="drop-select" id="q1">
						<option value="" disabled selected>Your mind is always buzzing with unexplored ideas and plans.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 1</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q2">
						<option value="" disabled selected>Generally speaking, you rely more on your experience than your imagination.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 2</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q3">
						<option value="" disabled selected>You find it easy to stay relaxed and focused even when there is some pressure.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 3</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q4">
						<option value="" disabled selected>You rarely do something just out of sheer curiosity.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 4</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q5">
						<option value="" disabled selected>People can rarely upset you.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 5</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q6">
						<option value="" disabled selected>It is often difficult for you to relate to other people’s feelings.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 6</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q7">
						<option value="" disabled selected>In a discussion, truth should be more important than people’s sensitivities.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 7</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q8">
						<option value="" disabled selected>You rarely get carried away by fantasies and ideas.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 8</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q9">
						<option value="" disabled selected>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 9</label>
				</div>
				<div class="input-field col s12">
					<select class="drop-select" id="q10">
						<option value="" disabled selected>It is often difficult for you to relate to other people’s feelings.</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					<label>Question 10</label>
				</div>
			</form>
			</div>


			<!-- Submit Button -->
			<button type="submit" class="waves-effect waves-light blue btn" id="submit">
				<i class="fa fa-check-circle" aria-hidden="true"></i>&nbsp;&nbsp;Submit
			</button>
			<br>
			<br>
			
			<hr>
			<a href="/api/friends">API Friends List</a> | <a href="https://github.com/Dhwyll/Friend-Finder">GitHub Repo</a>

		</div>

		<!-- Modal to show results -->
		<div id="resultsModal" class="modal">

			<!-- Modal content-->
			<div class="modal-content">
				<h4><strong>Best Match</strong></h4>
				<hr>
				<br>
				<h4 id="matchName" class="center-align">Name</h4>
				<div class="row">
					<div class="col s12 center">
						<img id="matchImg" src="https://cdn0.iconfinder.com/data/icons/user-pictures/100/unknown_1-2-512.png" height=300 alt="" onerror="this.src = 'https://cdn0.iconfinder.com/data/icons/user-pictures/100/unknown_1-2-512.png'">
					</div>
				</div>
				<hr>
			</div>
			<div class="modal-footer">
				<a href="#!" class="modal-action modal-close waves-effect btn-flat">Cool!</a>
			</div>

		</div>

		<!-- Modal to request the form be filled out completely -->
		<div id="incompleteModal" class="modal">
				
			<!-- Modal content-->
			<div class="modal-content">
				<h4><strong>Incomplete Form!</strong></h4>
				<hr>
				Sorry, my friend, by you need to fill out all the items in the form.
				<hr>
			</div>
			<div class="modal-footer">
				<a href="#!" class="modal-action modal-close waves-effect btn-flat">Try Again</a>
			</div>

		</div>

	<script type="text/javascript">
		$(document).ready(function() {
			$('select').material_select();
			$('.modal').modal();
		});

		// Capture the form inputs 
		$("#submit").on("click", function(){

			// Form validation
			function validateForm() {
				var isValid = true;
				$('.form-control').each(function() {
					if (!$(this).val())
						isValid = false;
				});

				$('.drop-select').each(function() {
					if($(this).val() === null)
						isValid = false;
				});
				return isValid;
			}

			// If all required fields are filled
			if (validateForm() == true)
			{
				// Create an object for the user's data
				var userData = {
					name: $("#name").val(),
					photo: $("#photo").val(),
					scores: [parseInt($("#q1").val()), parseInt($("#q2").val()),
					parseInt($("#q3").val()), parseInt($("#q4").val()), parseInt($("#q5").val()),
					parseInt($("#q6").val()), parseInt($("#q7").val()), parseInt($("#q8").val()),
					parseInt($("#q9").val()), parseInt($("#q10").val()) ]
				}

				// Grab the URL of the website
				var currentURL = window.location.origin;

				// AJAX post the data to the friends API. 
				$.post(currentURL + "/api/friends", userData, function(data){

					// Grab the result from the AJAX post so that the best match's name and photo are displayed.
					$("#matchName").text(data.name);
					$('#matchImg').attr("src", data.photo);

					// Show the modal with the best match
					$('#resultsModal').modal('open');

				});
			}
			else
			{
				$('#incompleteModal').modal('open');
			}
			
			return false;
		});


	</script>

	</body>
</html>